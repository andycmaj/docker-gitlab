postgresqlstorage:
  image: sameersbn/postgresql:9.1-1
  volumes:
    - /opt/gitlab/db:/var/lib/postgresql
postgresql:
  image: sameersbn/postgresql:9.1-1
  volumes_from:
    - postgresqlstorage
  environment:
    - DB_USER=gitlab
    - DB_PASS=secretpassword
    - DB_NAME=gitlabhq_production
gitlabstorage:
  build: busybox
  volumes:
   - /opt/gitlab/data:/home/git/data
   - /opt/gitlab/logs:/var/log/gitlab
gitlab:
  build: .
  volumes_from:
    - gitlabstorage
  links:
   - redis:redisio
   - postgresql:postgresql
  ports:
   - "80:80"
   - "443:443"
   - "2222:22"
  environment:
   - GITLAB_HOST=gitlab.imshealth.com
   - GITLAB_HTTPS=false
   - GITLAB_EMAIL=git@us.imshealth.com
   - GITLAB_SIGNIN=false
   - GITLAB_PROJECTS_LIMIT=100000
   - NGINX_MAX_UPLOAD_SIZE=1024m
   - UNICORN_TIMEOUT=7200
   - LDAP_ENABLED=true
   - LDAP_HOST=10.38.64.21
   - LDAP_PORT=389
   - LDAP_UID=sAMAccountName
   - LDAP_METHOD=plain
   - LDAP_BIND_DN=CN=<your ldap display name here. ie, "Cunningham\\\\, Andrew (Seattle)">,OU=SEA - Users,OU=Seattle - SEA,OU=US,DC=internal,DC=imsglobal,DC=com
   - LDAP_PASS=<your password here>
   - LDAP_ACTIVE_DIRECTORY=true
   - LDAP_ALLOW_USERNAME_OR_EMAIL_LOGIN=true
   - LDAP_BASE=DC=internal,DC=imsglobal,DC=com
   - JIRA_URL=https://360vantage.jira.com
redis:
  image: sameersbn/redis:latest
